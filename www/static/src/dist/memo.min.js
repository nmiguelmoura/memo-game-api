/*Created by Nuno Machado*/

"use strict";nmm.uiPIXI.TexturedBtn=function(){function a(a){PIXI.Container.call(this),this._shadowTexture=a.shadowTexture||null,this._fillTexture=a.fillTexture||null,this._secondaryFillTexture=a.secondaryFillTexture||null,this._activeTexture="primary",this._x=a.x||0,this._y=a.y||0,this._defaultCursor=a.defaultCursor,this._shadowOffsetX=a.shadowOffsetX||0,this._shadowOffsetY=a.shadowOffsetY||0,this._key=a.key||0,this._autoHide=a.autoHide,void 0===this._autoHide&&(this._autoHide=!0),this._trackMouseDown=!0===a.trackMouseDown,this._callback=a.callback||function(){},this._startInteractive=void 0===a.startInteractive||a.startInteractive,this._scale=a.scale||.5,this.scale.set(this._scale),this.position.set(this._x,this._y),this._init()}return a.prototype=Object.create(PIXI.Container.prototype),a.prototype.constructor=a,a.prototype.destroyBtn=function(a){a=!0===a,this.removeListeners();try{this.parent.removeChild(this)}catch(a){}this._x=null,this._y=null,this._shadowOffsetX=null,this._shadowOffsetY=null,this._key=null,this._callback=null,this._scale=null,this._fillSprite.destroy({texture:a}),this._shadowSprite&&this._shadowSprite.destroy({texture:a}),this._fillTexture=null,this._shadowTexture=null,this.destroy()},a.prototype.tintBtn=function(a){this._fillSprite.tint=a},a.prototype.show=function(){this.visible||(this.visible=!0,this.addListeners())},a.prototype.hide=function(){this.visible&&(this.visible=!1,this.buttonMode=!1,this.removeListeners())},a.prototype._touchEndOutside=function(){this._shadowSprite&&(this._shadowSprite.visible=!0),this.off("mouseup",this._upHandler),this.off("touchend",this._upHandler),this.off("touchendoutside",this._touchEndOutside),this.off("mouseupoutside",this._touchEndOutside)},a.prototype._upHandler=function(a){this._shadowSprite&&(this._shadowSprite.visible=!0),this._autoHide&&this.hide(),this._callback(this._key,"up",a),this.off("mouseup",this._upHandler),this.off("touchend",this._upHandler),this.off("touchendoutside",this._touchEndOutside),this.off("mouseupoutside",this._touchEndOutside)},a.prototype._downHandler=function(a){this._shadowSprite&&(this._shadowSprite.visible=!1),this.on("mouseup",this._upHandler,!1),this.on("touchend",this._upHandler,!1),this.on("touchendoutside",this._touchEndOutside,!1),this.on("mouseupoutside",this._touchEndOutside,!1),this._trackMouseDown&&this._callback(this._key,"down")},a.prototype.addListeners=function(){this.buttonMode||(this.on("mousedown",this._downHandler,!1),this.on("touchstart",this._downHandler,!1),this.buttonMode=!0)},a.prototype.removeListeners=function(){this.off("touchstart",this._downHandler),this.off("touchend",this._upHandler),this.off("mousedown",this._downHandler),this.off("mouseup",this._downHandler),this.off("touchendoutside",this._touchEndOutside),this.off("mouseupoutside",this._touchEndOutside),this.buttonMode=!1},a.prototype._startInteractivity=function(){this.interactive=!0,this._defaultCursor&&(this.defaultCursor=this._defaultCursor),this._startInteractive&&this.addListeners()},a.prototype.setKey=function(a){this._key=a},a.prototype.switchTexture=function(a){"primary"===a?(this._fillSprite.texture=this._fillTexture,this._activeTexture="primary"):"secondary"===a?(this._fillSprite.texture=this._secondaryFillTexture,this._activeTexture="secondary"):(this._fillSprite.texture="primary"===this._activeTexture?this._secondaryFillTexture:this._fillTexture,this._activeTexture="primary"===this._activeTexture?"secondary":"primary")},a.prototype.updateFillTexture=function(a){this._fillTexture=this._getFillTexture(a),this._fillSprite.texture=this._fillTexture},a.prototype.updateSecondaryFillTexture=function(a){this._secondaryFillTexture=this._getFillTexture(a)},a.prototype._getFillTexture=function(a){if(null!==a)return a;throw new Error("No texture has been provided.")},a.prototype._buildBtn=function(){if(null===this._fillTexture)throw new Error("No texture has been provided.");this._fillSprite=new PIXI.Sprite(this._fillTexture),this._fillSprite.anchor.set(.5),this.addChild(this._fillSprite)},a.prototype._buildShadow=function(){this._shadowSprite=new PIXI.Sprite(this._shadowTexture),this._shadowSprite.anchor.set(.5),this._shadowSprite.position.set(this._shadowOffsetX,this._shadowOffsetY),this.addChild(this._shadowSprite)},a.prototype._init=function(){this._shadowTexture&&this._buildShadow(),this._buildBtn(),this._startInteractivity()},a}(),nmm.app.ViewProto=function(){function a(a){PIXI.Container.call(this),this.name=a,this.alpha=0}a.prototype=Object.create(PIXI.Container.prototype),a.constructor=a;var b=a.prototype;return b.viewOut=function(a){a(this.name)},b.viewIn=function(){},b.destroy=function(){this.removeChildren(),PIXI.Container.prototype.destroy.call(this,{children:!0,texture:!0})},b.animateOut=function(a){TweenLite.to(this,.5,{alpha:0}),TweenLite.delayedCall(.5,function(){this.viewOut(a)},[],this)},b.animateIn=function(){TweenLite.to(this,.5,{alpha:1}),TweenLite.delayedCall(.5,function(){this.viewIn()},[],this)},a}(),nmm.app.audioSprite=[{id:"silence",startTime:0,duration:1e3},{id:"correct",startTime:2e3,duration:1817.6643990929708},{id:"music",startTime:5e3,duration:24058.775510204083},{id:"wrong",startTime:31e3,duration:2433.1746031746065}],nmm.app.Pool=function(){function a(a,b){this._pool=[],this._maxElements=a,this._init(b)}var b=a.prototype;return b.returnToPool=function(a){a.reset(),a.alpha=1,a.scale.set(1),a.btn.hide(),a.key=null,a.callback=null,a.guessed=!1,this._pool.push(a)},b.borrowFromPool=function(){if(this._pool.length>0)return this._pool.pop();console.info("No more cards in pool!")},b._init=function(a){var b,c;for(b=0;b<this._maxElements;b++)c=new nmm.app.Card(a),c.anchor.set(.5),this._pool.push(c)},a}(),nmm.app.ScoreView=function(){function a(a,b){nmm.app.ViewProto.call(this,b),this._controller=a,this._topTexts={},this._rankingTexts={},this._tablesReady=0,this._init()}a.prototype=Object.create(nmm.app.ViewProto.prototype),a.prototype.constructor=a;var b=a.prototype;return b._incrementTableReady=function(){2===++this._tablesReady&&this._controller.scoreReady()},b._fillTable=function(a,b,c){var d,e,f=b.length,g="",h="";for(d=0;d<f;d++)e=b[d],g+=e.user_name+"\n",h+=c?Math.round(100*parseFloat(e.ranking))+"\n":e.score+"\n";a.playerName.setText(g),a.score.setText(h)},b.updateRanking=function(a){a.length>15&&a.splice(15,a.length-1),this._incrementTableReady(),this._fillTable(this._rankingTexts,a,!0)},b.updateScore=function(a){this._incrementTableReady(),this._fillTable(this._topTexts,a)},b.viewOut=function(){this._topTexts.playerName.setText(""),this._topTexts.score.setText(""),this._rankingTexts.playerName.setText(""),this._rankingTexts.score.setText(""),this._tablesReady=0},b._addColumn=function(a,b,c){var d=new PIXI.Container,e={fontFamily:"Arial",fontSize:"40px",fill:"#FFFFFF"},f=new PIXI.Text(b.title,e);f.position.set(0,0),d.addChild(f),e.fontSize="20px";var g=new PIXI.Text(b.subTitle,e);g.anchor.set(1,0),g.position.set(a,18),d.addChild(g);var h=new PIXI.Graphics;h.lineStyle(1,16777215,1).moveTo(0,0).lineTo(a,0),h.position.set(0,55),d.addChild(h),e.lineHeight=40;var i=new PIXI.Text("",e);i.position.y=75,d.addChild(i),c.playerName=i,e.align="right";var j=new PIXI.Text("",e);j.position.set(a,75),j.anchor.set(1,0),d.addChild(j),c.score=j,d.position.set(b.x,b.y),this.addChild(d)},b._init=function(){var a=this._controller.getInfo(this.name).info;this._addColumn(a.width,a.column0,this._topTexts),this._addColumn(a.width,a.column1,this._rankingTexts)},a}(),nmm.app.Card=function(){function a(a){this._numTotalCards=a,c||this._getTextures(),PIXI.extras.AnimatedSprite.call(this,c),this.gotoAndStop(this._numTotalCards-1),this.btn=null,this.key=null,this.callback=null,this.guessed=!1,this._init()}var b,c;a.prototype=Object.create(PIXI.extras.AnimatedSprite.prototype),a.prototype.constructor=a;var d=a.prototype;return d._click=function(){this.callback(this.key)},d.reset=function(a){var b=this._numTotalCards;a?this.turnCard(b):this.gotoAndStop(b)},d.showFrame=function(a){this.turnCard(a)},d.turnCard=function(a){var b=this.scale.x;TweenLite.to(this.scale,.25,{x:0}),TweenLite.delayedCall(.25,function(){this.gotoAndStop(a)},[],this),TweenLite.to(this.scale,.25,{x:b,delay:.25})},d._getTextures=function(){var a;for(c=[],a=0;a<this._numTotalCards;a++)c.push(PIXI.Texture.fromFrame("card-"+a));c.push(PIXI.Texture.fromFrame("card-secret"))},d._addBtn=function(){if(!b){var a=new PIXI.Graphics;a.beginFill(16711680,0).drawRect(0,0,10,10).endFill(),b=a.generateTexture()}this._clickBound=this._click.bind(this),this.btn=new nmm.uiPIXI.TexturedBtn({fillTexture:b,x:0,y:0,scale:1,autoHide:!0,callback:this._clickBound}),this.btn.width=192,this.btn.height=263,this.btn.hide(),this.addChild(this.btn)},d._init=function(){this._addBtn()},a}(),nmm.app.GameView=function(){function a(a,b,c){nmm.app.ViewProto.call(this,b),this._controller=a,this._pool=c,this._data=this._controller.getInfo(this.name),this._values={},this._cards=[],this._cardsTurned=[],this._init()}a.prototype=Object.create(nmm.app.ViewProto.prototype),a.prototype.constructor=a;var b=a.prototype;return b.gameOver=function(){this._greatSign.alpha=0,this._greatSign.rotation=0,this._greatSign.scale.set(2),this.addChild(this._greatSign),TweenLite.to(this._greatSign,.5,{alpha:1,rotation:-.2}),TweenLite.to(this._greatSign.scale,.5,{x:1,y:1,ease:Back.easeOut.config(2)})},b.enableRemainingCards=function(){this._cards.forEach(function(a){a.guessed||a.btn.show()})},b.markMoveCardsAsGuessed=function(){var a=this._cardsTurned[0],b=this._cardsTurned[1];this._cards[a].guessed=!0,this._cards[b].guessed=!0,this._cardsTurned=[]},b.resetLastMove=function(){var a=this._cardsTurned[0],b=this._cardsTurned[1];this._cards[a].reset(!0),this._cards[b].reset(!0),this._cardsTurned=[]},b.turnCard=function(a,b){var c=this._cardsTurned[a];this._cards[c].turnCard(b)},b.disableAllCards=function(){this._cards.forEach(function(a){a.btn.hide()})},b._click=function(a){this._cardsTurned.push(a),this._controller.cardTurned(this._cardsTurned)},b._distributeCards=function(a,b,c){var d,e,f,g,h=b.numCards;for(d=0;d<h;d++)f=c?"-1":a[d],g=b.disposal[d],e=this._pool.borrowFromPool(),"-1"===f?(e.reset(),e.btn.show()):(e.gotoAndStop(f),e.guessed=!0),e.key=d,e.callback=this._clickBound,e.scale.set(b.scale),e.position.set(512,900),TweenLite.to(e,1,{x:g.x,y:g.y,delay:.05*d}),this._cards.push(e),this.addChild(e)},b.updateValues=function(a,b){this._values.score.setText(a),this._values.moves.setText(b)},b.update=function(a,b){this.updateValues(a.score,a.move_record?a.move_record.length/2:0),this._distributeCards(a.tiles_found,b),this._cardsTurned=[]},b.playMoves=function(a){var b,c,d,e=a.length;for(this.disableAllCards(),b=0;b<e;b++)c=a[b],d=1.5+2*b,TweenLite.delayedCall(d,function(a){this._cards[a.move_one].turnCard(a.move_one_key),this._cards[a.move_two].turnCard(a.move_two_key),a.guessed||TweenLite.delayedCall(1,function(a){this._cards[a.move_one].reset(!0),this._cards[a.move_two].reset(!0)},[a],this)},[c],this);d=2+2*a.length,TweenLite.delayedCall(d,function(){this._controller.gameOver()},[],this)},b.playMode=function(a,b,c){this.updateValues(a,b.length),this._distributeCards([],c,!0),this.playMoves(b)},b.animateOut=function(a){this._cards.forEach(function(a){this.removeChild(a),this._pool.returnToPool(a)},this),this._cards.splice(0),nmm.app.ViewProto.prototype.animateOut.call(this,a)},b.viewOut=function(){this.removeChild(this._greatSign)},b._addGreatSign=function(){this._greatSign=new PIXI.Sprite(PIXI.Texture.fromFrame("great")),this._greatSign.anchor.set(.5),this._greatSign.position.set(512,384)},b._addStats=function(){var a,b,c,d=new PIXI.Container,e=this._data.info,f=e.length,g={fontFamily:"Arial",fontSize:"40px",fill:"#FFFFFF"};for(a=0;a<f;a++)b=e[a],g.align="left",c=new PIXI.Text(b.text,g),c.position.set(b.x,b.y),d.addChild(c),g.align="right",c=new PIXI.Text("",g),c.anchor.set(1,0),c.position.set(b.x+b.offset,b.y),d.addChild(c),this._values[b.name.toLowerCase()]=c;this.addChild(d)},b._init=function(){this._clickBound=this._click.bind(this),this._addStats(),this._addGreatSign()},a}(),nmm.app.GameListElement=function(){function a(a,b){PIXI.Container.call(this),this._controller=a,this._dataInfo=b.info,this._dataBtns=b.btns,this._valueTexts=[],this._btns=[],this.web_safe_key=null,this._init()}a.prototype=Object.create(PIXI.Container.prototype),a.prototype.constructor=a;var b=a.prototype;return b.disable=function(){this._btns.forEach(function(a){a.hide()})},b.update=function(a,b){this._mainText.setText("Jogo "+b),this._valueTexts[0].setText(a.score),this._valueTexts[0].setText(a.score),a.complete?this._btns[2].show():(this._btns[0].show(),this._btns[1].show()),this.web_safe_key=a.web_safe_key},b._click=function(a){switch(a){case 0:this._controller.loadGame(this.web_safe_key);break;case 1:this._controller.deleteGame(this.web_safe_key);break;case 2:this._controller.watchGame(this.web_safe_key)}},b._addBtns=function(){var a,b,c,d=this._dataBtns.length;for(a=0;a<d;a++)b=this._dataBtns[a],c=new nmm.uiPIXI.TexturedBtn({fillTexture:b.texture,x:b.x,y:b.y,scale:1,key:b.key,autoHide:!1,callback:this._clickBound}),c.hide(),this.addChild(c),this._btns.push(c)},b._addSecondaryTexts=function(){var a,b,c,d=this._dataInfo.length,e={fontFamily:"Arial",fontSize:"20px",fill:"#FFFFFF",align:"right"};for(a=0;a<d;a++)b=this._dataInfo[a],c=new PIXI.Text(b.text,e),c.position.set(b.x,b.y),c.anchor.set(1,0),this.addChild(c),c=new PIXI.Text("0",e),c.position.set(b.x+30,b.y),c.anchor.set(1,0),this.addChild(c),this._valueTexts.push(c)},b._addMainText=function(){var a={fontFamily:"Arial",fontSize:"30px",fill:"#FFFFFF"};this._mainText=new PIXI.Text("",a),this.addChild(this._mainText)},b._addGraph=function(){var a=new PIXI.Graphics;a.lineStyle(1,16777215,1).moveTo(0,0).lineTo(708,0),a.position.set(0,40),this.addChild(a)},b._init=function(){this._clickBound=this._click.bind(this),this._addGraph(),this._addMainText(),this._addSecondaryTexts(),this._addBtns()},a}(),nmm.app.GameSelectionView=function(){function a(a,b){nmm.app.ViewProto.call(this,b),this._controller=a,this._genericData=this._controller.getInfo(this.name),this._elements=[],this._init()}a.prototype=Object.create(nmm.app.ViewProto.prototype),a.prototype.constructor=a;var b=a.prototype;return b.clear=function(){this._elements.forEach(function(a){this.removeChild(a),a.disable()},this)},b.update=function(a){if(a){this._infoText.setText(""),a.length>5&&a.splice(5,a.length-1);var b,c,d=a.length,e=this._elements.length-1;for(b=0;b<d;b++)b>e?(c=this._createElement(),this._elements.push(c)):c=this._elements[b],c.update(a[b],b+1),c.position.set(158,87+129*b),this.addChild(c)}else this._infoText.setText("Não há jogos guardados.")},b.viewIn=function(){},b.viewOut=function(){this._infoText.setText(""),this._elements.forEach(function(a){this.removeChild(a)},this)},b.animateOut=function(a){this._elements.forEach(function(a){a.disable()},this),nmm.app.ViewProto.prototype.animateOut.call(this,a)},b._createElement=function(){return new nmm.app.GameListElement(this._controller,this._genericData)},b._addInfoText=function(){var a={fontFamily:"Arial",fontSize:"20px",fill:"#FFFFFF"};this._infoText=new PIXI.Text("",a),this._infoText.position.set(158,87),this.addChild(this._infoText)},b._init=function(){this._addInfoText()},a}(),nmm.app.DifficultyView=function(){function a(a,b){nmm.app.ViewProto.call(this,b),this._controller=a,this._btns=[],this._init()}a.prototype=Object.create(nmm.app.ViewProto.prototype),a.prototype.constructor=a;var b=a.prototype;return b.viewIn=function(){},b.animateOut=function(a){this._btns.forEach(function(a){a.hide()}),nmm.app.ViewProto.prototype.animateOut.call(this,a)},b.animateIn=function(){this._btns.forEach(function(a){a.show()}),nmm.app.ViewProto.prototype.animateIn.call(this)},b._click=function(a){this._controller.createGame(a)},b._addOptions=function(){var a,b,c=this._controller.getInfo(this.name).btns,d={fontFamily:"Arial",fontSize:"120px",fill:"#FFFFFF"},e=new PIXI.Graphics,f=new PIXI.Text("",d);e.addChild(f),c.forEach(function(c,d){f.setText(c.text),b=e.generateTexture(),a=new nmm.uiPIXI.TexturedBtn({fillTexture:b,x:c.x,y:c.y,key:c.key,scale:.5,autoHide:!1,callback:this._clickBound}),a.hide(),this.addChild(a),this._btns.push(a)},this)},b._init=function(){this._clickBound=this._click.bind(this),this._addOptions()},a}(),nmm.app.MenuView=function(){function a(a,b){nmm.app.ViewProto.call(this,b),this._controller=a,this._btns=[],this._init()}a.prototype=Object.create(nmm.app.ViewProto.prototype),a.prototype.constructor=a;var b=a.prototype;return b.animateOut=function(a){this._btns.forEach(function(a){a.hide()}),nmm.app.ViewProto.prototype.animateOut.call(this,a)},b._click=function(a){switch(a){case 0:this._controller.attemptLogin();break;case 1:this._controller.allowDifficultySelect();break;case 2:this._controller.showStoredGames(!1);break;case 3:this._controller.showStoredGames(!0)}},b.showMenu=function(){this._btns.forEach(function(a){a.show()},this)},b.killLoader=function(){this._loaderOn&&(nmm.runtime.appSetup.app.ticker.remove(this._loaderUpdateBound),this.removeChild(this._loader),this._loader.destroy({children:!0,texture:!0}),this._loaderOn=!1)},b.checkStatus=function(){this._controller.isUserLogged()?(this._loginBtn.hide(),this._btns.forEach(function(a){a.show()},this),this._loaderOn&&(nmm.runtime.appSetup.app.ticker.remove(this._loaderUpdateBound),this.removeChild(this._loader),this._loader.destroy({children:!0,texture:!0}),this._loaderOn=!1)):(this._loginBtn.show(),this._btns.forEach(function(a){a.hide()},this))},b._addOptions=function(){this._optionsContainer=new PIXI.Container;var a,b,c=this._controller.getInfo(this.name).btns,d={fontFamily:"Arial",fontSize:"120px",fill:"#FFFFFF"},e=new PIXI.Graphics,f=new PIXI.Text("",d);e.addChild(f),c.forEach(function(c,d){f.setText(c.text),b=e.generateTexture(),a=new nmm.uiPIXI.TexturedBtn({fillTexture:b,x:c.x,y:c.y,key:c.key,scale:.5,autoHide:!1,callback:this._clickBound}),a.hide(),this._optionsContainer.addChild(a),this._btns.push(a)},this),this.addChild(this._optionsContainer)},b._addTitle=function(){var a=new PIXI.Container,b=new PIXI.Sprite.fromFrame("title-0");b.position.set(67,72),a.addChild(b);var c=new PIXI.Sprite.fromFrame("title-1");c.position.set(294,321),a.addChild(c),this.addChild(a)},b._loaderUpdate=function(){this._loader.rotation+=.02},b._addLoader=function(){this._loader=new PIXI.Sprite(PIXI.Texture.fromFrame("loader")),this._loader.anchor.set(.5),this._loader.position.set(512,638),this.addChild(this._loader),this._loaderOn=!0},b._init=function(){this._addTitle(),this._clickBound=this._click.bind(this),this._addLoader(),this._addOptions(),this._loaderUpdateBound=this._loaderUpdate.bind(this),nmm.runtime.appSetup.app.ticker.add(this._loaderUpdateBound)},a}(),nmm.app.NameInputView=function(){function a(a,b,c){nmm.app.ViewProto.call(this,b),this._controller=a,this._data=c,this._init()}a.prototype=Object.create(nmm.app.ViewProto.prototype),a.prototype.constructor=a;var b=a.prototype;return b.animateOut=function(a){nmm.app.ViewProto.prototype.animateOut.call(this,a)},b.viewOut=function(){this.removeChild(this._title),this._title.destroy({children:!0,texture:!0}),this._title=null,this.removeChild(this._rectangle),this._rectangle.clear(),this._rectangle.destroy(),this._rectangle=null,this.removeChild(this._nameField),this._nameField.destroy({children:!0,texture:!0}),this._nameField=null,this.removeChild(this._keyboard),this._keyboard.destroy({children:!0,texture:!0}),this._keyboard=null,this._keyboardBtn.hide(),this.removeChild(this._keyboardBtn),this._keyboardBtn.destroyBtn(),this._keyboardBtn=null,this.removeChild(this._btnText),this._btnText.destroy({children:!0,texture:!0}),this._btnText=null,this._btn.hide(),this.removeChild(this._btn),this._btn.destroyBtn(),this._btn=null},b.viewIn=function(){this._keyboardBtn.show()},b.updateName=function(a){this._nameField.text=a},b._clickContinue=function(){this._controller.nameReady()},b.clickKeyboard=function(a,b,c){var d=c.data.getLocalPosition(nmm.runtime.scene);this._controller.keyboardClicked(d)},b._addBtn=function(){var a=this._data.btn,b={fontFamily:"Arial",fontSize:a.fontSize,fill:"#FFFFFF"};this._btnText=new PIXI.Text(a.text,b),this._btnText.anchor.set(.5),this._btnText.scale.set(.5),this._btnText.position.set(a.x,a.y),this.addChild(this._btnText);var c=(new PIXI.Graphics).beginFill(16711680,0).drawRect(0,0,a.width,a.height).endFill();this._clickContinueBound=this._clickContinue.bind(this),this._btn=new nmm.uiPIXI.TexturedBtn({fillTexture:c.generateTexture(),x:a.x,y:a.y,callback:this._clickContinueBound}),this._btn.width=a.width,this._btn.height=a.height,this.addChild(this._btn)},b._addKeyboard=function(){var a=this._data.keyboard;this._keyboard=new PIXI.Sprite(PIXI.Texture.fromFrame(a.frame)),this._keyboard.anchor.set(a.anchor),this._keyboard.position.set(a.x,a.y),this.addChild(this._keyboard);var b=(new PIXI.Graphics).beginFill(16711680,0).drawRect(0,0,10,10).endFill();this._clickKeyboardBound=this.clickKeyboard.bind(this),this._keyboardBtn=new nmm.uiPIXI.TexturedBtn({fillTexture:b.generateTexture(),x:a.x,y:a.y,autoHide:!1,callback:this._clickKeyboardBound}),this._keyboardBtn.width=a.width,this._keyboardBtn.height=a.height,this._keyboardBtn.hide(),this.addChild(this._keyboardBtn)},b._addNameField=function(){var a=this._data.nameText,b={fontFamily:"Arial",fontSize:a.fontSize,fontStyle:a.fontStyle,fill:"#FFFFFF"},c=this._controller.getPlayerName()||"";this._nameField=new PIXI.Text(c,b),this._nameField.scale.set(a.scale),this._nameField.position.set(a.x,a.y),this.addChild(this._nameField)},b._addRectangle=function(){var a=this._data.rectangle;this._rectangle=(new PIXI.Graphics).lineStyle(a.stroke,a.borderColor,1).beginFill(a.fill,a.fillAlpha).drawRect(a.x,a.y,a.width,a.height).endFill(),this.addChild(this._rectangle)},b._addText=function(){var a=this._data.title,b={fontFamily:"Arial",fill:"#ffffff",fontSize:a.fontSize};this._title=new PIXI.Text(a.text,b),this._title.anchor.set(.5),this._title.scale.set(.5),this._title.position.set(a.x,a.y),this.addChild(this._title)},b._init=function(){this._addText(),this._addRectangle(),this._addNameField(),this._addKeyboard(),this._addBtn()},a}(),nmm.app.LogoView=function(){function a(a,b,c){nmm.app.ViewProto.call(this,b),this._controller=a,this._data=c,this._texts=[],this._init()}a.prototype=Object.create(nmm.app.ViewProto.prototype),a.prototype.constructor=a;var b=a.prototype;return b.animateOut=function(a){nmm.app.ViewProto.prototype.animateOut.call(this,a)},b.viewOut=function(){this.removeChild(this._logo),this._logo.destroy({children:!0,texture:!0}),this._logo=null,this._texts.forEach(function(a){this.removeChild(a),a.destroy({children:!0,texture:!0}),a=null},this),this._texts=null},b.viewIn=function(){TweenLite.delayedCall(1.5,function(){this._controller.startNameInputView()},[],this)},b._addTexts=function(){var a,b=this._data.texts,c={fontFamily:"Arial",fill:"#ffffff"};b.forEach(function(b){c.fontSize=b.fontSize,a=new PIXI.Text(b.text,c),a.anchor.set(b.anchor),a.position.set(b.x,b.y),a.scale.set(b.scale),this.addChild(a),this._texts.push(a)},this)},b._addLogo=function(){var a=this._data.image;this._logo=new PIXI.Sprite(PIXI.Texture.fromFrame(a.frame)),this._logo.anchor.set(.5),this._logo.position.set(a.x,a.y),this.addChild(this._logo)},b._init=function(){this._addLogo(),this._addTexts()},a}(),nmm.app.Bg=function(){function a(a,b,c){PIXI.Container.call(this),this._pool=a,this._data=b,this._numDifferentCards=c,this._lines={},this._init()}a.prototype=Object.create(PIXI.Container.prototype),a.prototype.constructor=a;var b=a.prototype;return b._onFrameUpdate=function(){var a,b,c,d=this._data.numLines,e=this._data.numCardsPerLine,f=this._data.speeds;for(a=0;a<d;a++)for(b=0;b<e;b++)c=this._lines["line"+a][b],c.position.y-=f[a],c.position.y<-137&&(c.position.y=954)},b._addCards=function(){var a,b,c,d=new PIXI.Container,e=this._data.numLines,f=this._data.numCardsPerLine;for(a=0;a<e;a++)for(this._lines["line"+a]=[],b=0;b<f;b++)c=this._pool.borrowFromPool(),c.position.set(108+202*a,10+273*b-a%2*136.5),c.alpha=.2,c.gotoAndStop(Math.round(Math.random()*(this._numDifferentCards-1))),d.addChild(c),this._lines["line"+a].push(c);this.addChild(d)},b._addBgImage=function(){var a=new PIXI.Sprite(PIXI.Texture.fromImage("static/assets/images/bg.jpg"));this.addChild(a)},b._init=function(){this._addBgImage(),this._addCards(),this._onFrameUpdateBound=this._onFrameUpdate.bind(this),nmm.runtime.appSetup.app.ticker.add(this._onFrameUpdateBound)},a}(),nmm.app.ViewManager=function(){function a(a){this._controller=a,this.views={},this.activeView=null,this._callOutBound=this._callOut.bind(this)}var b=a.prototype;return b._callOut=function(a){this._controller.removeChild(this.getView(a))},b.changeActiveView=function(a){if(this.activeView&&this.activeView.animateOut(this._callOutBound),this.activeView=this.views[a],this.activeView)return this._controller.addChild(this.activeView),this.activeView.animateIn(),this.activeView;console.info("There is no view available with that name (--\x3e "+name+" <--).")},b.getView=function(a){if(this.views[a])return this.views[a];console.info("There is no view available with that name (--\x3e "+a+" <--).")},b.registerView=function(a,b){var c=a.name;this.views[c]?console.info("There is already a view with that name (--\x3e "+c+" <--) registered! Please choose another name or use method getView(name) with chosen name as argument."):(this.views[c]=a,b&&this.changeActiveView(c))},a}(),nmm.app.Logic=function(){function a(){}var b=a.prototype;return b.sort_data=function(a,b){function c(b,c){return b[a]<c[a]?1:b[a]>c[a]?-1:0}return b.sort(c)},b.create_player_ranking=function(a){var b=this.get_player_ranking(a);if(!b){b={guessed_moves:0,ranking:0,total_moves:0,user_name:a};var c=this.get_rankings();c[a]=b,localStorage.setItem("ranking",JSON.stringify(c))}},b.update_player_ranking=function(a,b){var c=this.get_rankings();c&&c[a]&&(c[a]={guessed_moves:b.guessed_moves,ranking:b.ranking,total_moves:b.total_moves,user_name:a},localStorage.setItem("ranking",JSON.stringify(c)))},b.get_rankings=function(){var a=localStorage.getItem("ranking");return a=a?JSON.parse(a):{}},b.get_player_ranking=function(a){return this.get_rankings()[a]},b.save_move_data=function(a,b,c,d,e,f){var g=this.get_game_slots();g&&g[a]&&(g[a].score=d,g[a].move_record.push(b,c),g[a].complete=e,g[a].tiles_found=f),localStorage.setItem("game",JSON.stringify(g))},b.save_game_slot=function(a){var b=this.get_game_slots();b[a.creation_date]=a,localStorage.setItem("game",JSON.stringify(b))},b.get_game_slots=function(){var a=localStorage.getItem("game");return a=a?JSON.parse(a):{}},b.create_game=function(a,b){a=a||"easy",b=b||"JOGADOR 1";var c=function(a){var b=[],c=[],d=null;switch(a){case"easy":d=5;break;case"medium":d=8;break;case"hard":d=12;break;default:d=5,a="easy"}for(var e=0;e<d;e++)b.push(e.toString(),e.toString()),c.push("-1","-1");return b=nmm.utils.shuffleArray(b),{level:a,sequence:b,found:c}}(a),d=+new Date,e={complete:!1,creation_date:d,level:a,score:0,tile_number:10,tiles_found:c.found,sequence:c.sequence,move_record:[],user_name:b,web_safe_key:d};return this.save_game_slot(e),this.create_player_ranking(b),e},b.get_existing_game=function(a){var b=this.get_game_slots();if(b[a])return b[a]},b.get_games_list=function(a){var b=this.get_game_slots(),c=[];for(var d in b)b.hasOwnProperty(d)&&b[d].complete===a&&c.push(b[d]);return{result:{items:c.length>0?c:null}}},b.make_move=function(a,b,c){var d="-1",e="-1";void 0!==a&&(d=c.sequence[a]),void 0!==b&&(e=c.sequence[b]);var f=!1;if("-1"!==d&&"-1"!==e){var g=null,h=this.get_player_ranking(c.user_name);if(h.total_moves=h.total_moves+1,d===e){f=!0,c.score+=3,c.tiles_found[a]=d,c.tiles_found[b]=e,g=!0;for(var i=c.tiles_found.length,j=0;j<i;j++)if("-1"===c.tiles_found[j]){g=!1;break}c.complete=g,h.guessed_moves=h.guessed_moves+1}else c.score-=1,c.score<0&&(c.score=0);this.save_move_data(c.creation_date,a,b,c.score,c.complete,c.tiles_found),h.ranking=h.guessed_moves/h.total_moves,this.update_player_ranking(c.user_name,h)}return{move_one_key:d,move_two_key:e,complete:g,guessed:f,score:c.score}},b.score=function(){var a=this.get_game_slots(),b=[];for(var c in a)a.hasOwnProperty(c)&&a[c].complete&&b.push(a[c]);return b=this.sort_data("score",b),{result:{items:b}}},b.rankings=function(){var a=this.get_rankings(),b=[];for(var c in a)a.hasOwnProperty(c)&&b.push(a[c]);return b=this.sort_data("ranking",b),{result:{items:b}}},b.history=function(a){var b=this.get_existing_game(a);if(b)return{level:b.level,score:b.score,history:function(a,b){for(var c,d,e=null,f=b.length/2,g=[],h=0;h<f;h++)c=b[2*h],d=b[2*h+1],e={move_one:c,move_two:d,move_one_key:a[c],move_two_key:a[d],guessed:a[c]===a[d]},g.push(e);return g}(b.sequence,b.move_record)}},b.cancel=function(a){var b=this.get_game_slots();b[a]&&delete b[a],localStorage.setItem("game",JSON.stringify(b))},a}(),nmm.app.Model=function(){function a(a){b=this,this._controller=a,this._logic=new nmm.app.Logic,this.isUserLogged=!1,this.poolMaxElements=48,this.playerName=null,this.bg={numLines:5,numCardsPerLine:4,speeds:[.15,.25,.2,.15,.2]},this.logo={image:{frame:"logo-cdc",x:512,y:315},texts:[{text:"Casa das Ciências",fontSize:"116px",x:512,y:560,anchor:.5,scale:.5},{text:"RECURSOS EDUCATIVOS PARA PROFESSORES",fontSize:"40px",x:512,y:625,anchor:.5,scale:.5}]},this.nameInput={title:{fontSize:"112px",text:"Como te chamas?",anchor:.5,scale:.5,x:512,y:142},rectangle:{x:173,y:216,width:680,height:72,borderColor:14507100,fillColor:16777215,fillAlpha:.1,stroke:2},nameText:{fontSize:"80px",fontStyle:"italic",x:186,y:230,scale:.5},keyboard:{frame:"keyboard",anchor:.5,x:512,y:469,width:680,height:273},btn:{text:"Continuar",fontSize:"40px",anchor:.5,scale:.5,x:512,y:652,width:100,height:60}},this.menu={btns:[{x:512,y:582,key:1,text:"Novo jogo"},{x:264,y:689,key:2,text:"Abrir jogo"},{x:772,y:689,key:3,text:"Ver histórico"}]},this.difficulty={btns:[{x:512,y:220,key:0,text:"Fácil"},{x:512,y:384,key:1,text:"Médio"},{x:512,y:547,key:2,text:"Difícil"}],selected:null},this.gameSelection={listMaxLength:5,info:[{text:"Pontos:",x:680,y:50}],btns:[{texture:PIXI.Texture.fromFrame("load"),x:636,y:15,key:0},{texture:PIXI.Texture.fromFrame("delete"),x:687,y:15,key:1},{texture:PIXI.Texture.fromFrame("play"),x:683,y:15,key:2}]},this.game={numTotalCards:12,easy:{numCards:10,disposal:[{x:116,y:249},{x:314,y:249},{x:512,y:249},{x:710,y:249},{x:910,y:249},{x:116,y:519},{x:314,y:519},{x:512,y:519},{x:710,y:519},{x:910,y:519}],scale:1},medium:{numCards:16,disposal:[{x:136,y:208},{x:287,y:208},{x:437,y:208},{x:588,y:208},{x:738,y:208},{x:889,y:208},{x:136,y:413},{x:287,y:413},{x:437,y:413},{x:588,y:413},{x:738,y:413},{x:889,y:413},{x:287,y:618},{x:437,y:618},{x:588,y:618},{x:738,y:618}],scale:.76},hard:{numCards:24,disposal:[{x:79,y:225},{x:202,y:225},{x:325,y:225},{x:448,y:225},{x:570,y:225},{x:694,y:225},{x:817,y:225},{x:941,y:225},{x:79,y:393},{x:202,y:393},{x:325,y:393},{x:448,y:393},{x:570,y:393},{x:694,y:393},{x:817,y:393},{x:941,y:393},{x:79,y:562},{x:202,y:562},{x:325,y:562},{x:448,y:562},{x:570,y:562},{x:694,y:562},{x:817,y:562},{x:941,y:562}],scale:.62},info:[{name:"score",text:"Pontos",x:40,y:26,offset:177},{name:"moves",text:"Jogadas",x:780,y:26,offset:200}],current:{}},this.score={info:{width:405,column0:{title:"Pontuação",subTitle:"pts.",x:57,y:57},column1:{title:"Ranking",subTitle:"% certas",x:562,y:57}}},this._keyboardGrid={originX:174,originY:334,lines:4,columns:10,width:68,height:68,order:[["0","1","2","3","4","5","6","7","8","9"],["A","B","C","D","E","F","G","H","I","J"],["K","L","M","N","O","P","Q","R","S","T"],["U","V","W","X","Y","Z","SPACE","SPACE","SPACE","DELETE"]]}}var b,c="",d=a.prototype;return d.getRankings=function(){this._controller.rankingLoaded(this._logic.rankings())},d.getTopScore=function(){this._controller.scoreLoaded(this._logic.score())},d.getGameHistory=function(a){
var c=this._logic.history(a);c&&b._controller.gameHistoryLoaded(c.level,c.score,c.history)},d.deleteGame=function(a){this._logic.cancel(a),this.getUnfinishedGames()},d.loadGame=function(a){var b=this._logic.get_existing_game(a);this.game.current=b,this._controller.gameDataLoaded(b)},d.getFinishedGames=function(){this._controller.gameListReady(this._logic.get_games_list(!0))},d.getUnfinishedGames=function(){this._controller.gameListReady(this._logic.get_games_list(!1))},d.updateMoveRecord=function(a,b){this.game.current.move_record||(this.game.current.move_record=[]),this.game.current.move_record.push(a,b)},d.makeMove=function(a){var c,d=a[0];2===a.length&&(c=a[1],this.updateMoveRecord(d,c));var e=this._logic.make_move(d,c,this.game.current);e&&b._controller.movePosted(e)},d.createGame=function(a){a=["easy","medium","hard"][a],b.game.current=this._logic.create_game(a,this._playerName),b._controller.gameCreated(b.game.current)},d.keyboardClicked=function(a){var b=a.x-this._keyboardGrid.originX,d=a.y-this._keyboardGrid.originY,e=Math.floor(d/this._keyboardGrid.height),f=Math.floor(b/this._keyboardGrid.width),g=this._keyboardGrid.order[e][f];switch(g){case"SPACE":c.length<15&&""!==c&&(c+=" ");break;case"DELETE":c=c.substring(0,c.length-1);break;default:c.length<15&&(c+=g)}return c},d.storePlayerName=function(){this._playerName=""!==c?c:"JOGADOR 1",localStorage.setItem("playerName",this._playerName)},d.getPlayerName=function(){var a=localStorage.getItem("playerName");return a?(c=a,a):null},a}(),nmm.app.SceneController=function(){function a(){PIXI.Container.call(this),this._init()}a.prototype=Object.create(PIXI.Container.prototype),a.prototype.constructor=a;var b=a.prototype;return b.scoreReady=function(){TweenLite.delayedCall(4,function(){this._viewManager.changeActiveView("menu"),this._menuView.showMenu()},[],this)},b.rankingLoaded=function(a){this._scoreView.updateRanking(a.result.items)},b.scoreLoaded=function(a){this._scoreView.updateScore(a.result.items)},b.gameOver=function(){this._model.getTopScore(),this._model.getRankings(),this._viewManager.changeActiveView("score")},b.gameHistoryLoaded=function(a,b,c){this._gameView.playMode(b,c,this._model.game[a])},b.watchGame=function(a){this._model.getGameHistory(a),this._viewManager.changeActiveView("game")},b.deleteGame=function(a){this._gameSelectionView.clear(),this._model.deleteGame(a)},b.gameDataLoaded=function(a){this._gameView.update(a,this._model.game[a.level])},b.loadGame=function(a){this._model.loadGame(a),this._viewManager.changeActiveView("game")},b.gameListReady=function(a){this._gameSelectionView.update(a.result.items),a.result.items||TweenLite.delayedCall(2,function(){this._viewManager.changeActiveView("menu"),this._menuView.showMenu()},[],this)},b.showStoredGames=function(a){a?this._model.getFinishedGames():this._model.getUnfinishedGames(),this._viewManager.changeActiveView("gameSelection")},b.enableRemainingCards=function(a){TweenLite.delayedCall(a,function(){this._gameView.enableRemainingCards()},[],this)},b.movePosted=function(a){"-1"===a.move_two_key?this._gameView.turnCard(0,parseInt(a.move_one_key)):(this._gameView.turnCard(1,parseInt(a.move_two_key)),this._gameView.updateValues(a.score,this._model.game.current.move_record.length/2),a.guessed?(nmm.runtime.audio.playSound("audioSprite","correct"),this._gameView.markMoveCardsAsGuessed(),a.complete?(TweenLite.delayedCall(1,function(){this._gameView.gameOver()},[],this),TweenLite.delayedCall(3,function(){this.gameOver()},[],this)):this.enableRemainingCards(.5)):(nmm.runtime.audio.playSound("audioSprite","wrong"),TweenLite.delayedCall(1,function(){this._gameView.resetLastMove(),this.enableRemainingCards(.5)},[],this)))},b.cardTurned=function(a){this._model.makeMove(a),2===a.length&&this._gameView.disableAllCards()},b.gameCreated=function(a){this._gameView.update(a,this._model.game[a.level])},b.createGame=function(a){this._model.createGame(a),this._viewManager.changeActiveView("game")},b.allowDifficultySelect=function(){this._viewManager.changeActiveView("difficulty")},b.startMenu=function(){this._menuView.killLoader(),this._menuView.showMenu()},b.nameReady=function(){this._model.storePlayerName(),this._viewManager.changeActiveView("menu"),this.startMenu()},b.keyboardClicked=function(a){this._nameInputView.updateName(this._model.keyboardClicked(a))},b.getPlayerName=function(){return this._model.getPlayerName()},b.startNameInputView=function(){this._viewManager.changeActiveView("nameInput")},b.getInfo=function(a){return this._model[a]},b._registerViews=function(){this._viewManager=new nmm.app.ViewManager(this),this._logoView=new nmm.app.LogoView(this,"logo",this._model.logo),this._viewManager.registerView(this._logoView,!0),this._nameInputView=new nmm.app.NameInputView(this,"nameInput",this._model.nameInput),this._viewManager.registerView(this._nameInputView),this._menuView=new nmm.app.MenuView(this,"menu"),this._viewManager.registerView(this._menuView),this._difficultyView=new nmm.app.DifficultyView(this,"difficulty"),this._viewManager.registerView(this._difficultyView),this._gameSelectionView=new nmm.app.GameSelectionView(this,"gameSelection"),this._viewManager.registerView(this._gameSelectionView),this._gameView=new nmm.app.GameView(this,"game",this._pool),this._viewManager.registerView(this._gameView),this._scoreView=new nmm.app.ScoreView(this,"score"),this._viewManager.registerView(this._scoreView)},b._init=function(){this._model=new nmm.app.Model(this),this._pool=new nmm.app.Pool(this._model.poolMaxElements,this._model.game.numTotalCards);var a=new nmm.app.Bg(this._pool,this._model.bg,this._model.game.numTotalCards);this.addChild(a),this._registerViews(),nmm.runtime.audio.playBgSound("audioSprite","music")},a}(),nmm.engine.AudioManager=function(){function a(a){b=this,this._soundBg=null,this._soundFX=null,this._sound=null,this._audioSpriteData=a}var b;return a.prototype._searchForSound=function(a){var b,c=this._audioSpriteData.length;for(b=0;b<c;b++)if(a===this._audioSpriteData[b].id)return this._audioSpriteData[b];return null},a.prototype.stopSound=function(){this._soundFX&&this._sound.stop()},a.prototype.playSound=function(a,c,d){d=d||function(){};var e=this._searchForSound(c);e&&(this._soundFX&&this._sound.stop(),this._soundFX=c,this._sound=createjs.Sound.play(a,e),this._sound.on("complete",function(){b._soundFX=null,d()}))},a.prototype.playBgSound=function(a,b){var c=this._searchForSound(b);c&&(this._bgSound=createjs.Sound.play(a,c),this._bgSound.volume=.5,this._bgSound.loop=1e4)},a}(),nmm.engine.AssetsLoader=function(){function a(a){b=this,this._assetsLoaded={sound:!1,atlas:!1},this._loader=null,this._callback=a,this._init()}var b,c={ss1:["static/assets/images/atlas00@1x.json"],ss2:["static/assets/images/atlas00@2x.json","assets/images/atlas01@2x.json"]};return a.prototype._checkFirstSoundsAndAtlas=function(){this._assetsLoaded.sound&&this._assetsLoaded.atlas&&this._callback()},a.prototype._loadGraphics=function(){this._loader=PIXI.loader,nmm.runtime.appSetup.loader=this._loader,c["ss"+nmm.runtime.dimensions.resolution].forEach(function(a){b._loader.add(a)}),b._loader.add("static/assets/images/bg.jpg"),this._loader.load(function(a,c){b._assetsLoaded.atlas=!0,b._checkFirstSoundsAndAtlas()})},a.prototype._loadAudioSprite=function(){createjs.Sound.on("fileload",function(){b._assetsLoaded.sound=!0,b._checkFirstSoundsAndAtlas()}),createjs.Sound.registerSound("static/assets/sounds/audioSprite.mp3","audioSprite")},a.prototype._init=function(){this._loadAudioSprite(),this._loadGraphics()},a}(),nmm.tools.Preloader=function(){function a(){PIXI.Container.call(this),this._init()}a.prototype=Object.create(PIXI.Container.prototype),a.prototype.constructor=a;var b=a.prototype;return b.destroy=function(){nmm.runtime.appSetup.app.ticker.remove(this._onFrameUpdateBound),this.removeChildren(),this._icon.destroy({children:!0,texture:!0}),this._text.destroy({children:!0,texture:!0}),PIXI.Container.prototype.destroy.call(this,{children:!0})},b._onFrameUpdate=function(){this._icon.rotation+=.02},b._addText=function(){var a={font:"28px Arial",fill:"#FFFFFF"};this._text=new PIXI.Text("Loading...",a),this._text.anchor.set(.5),this._text.scale.set(.5),this._text.position.set(nmm.runtime.dimensions.width/2,nmm.runtime.dimensions.height/2+45),this.addChild(this._text)},b._addGraph=function(){this._icon=new PIXI.Graphics,this._icon.beginFill(16777215,1).drawCircle(0,-40,5).beginFill(16777215,.9).drawCircle(-28,-28,5).beginFill(16777215,.8).drawCircle(-40,0,5).beginFill(16777215,.7).drawCircle(-28,28,5).beginFill(16777215,.6).drawCircle(0,40,5).beginFill(16777215,.5).drawCircle(28,28,5).beginFill(16777215,.4).drawCircle(40,0,5).beginFill(16777215,.3).drawCircle(28,-28,5).endFill(),this._icon.position.set(nmm.runtime.dimensions.width/2,nmm.runtime.dimensions.height/2),this._icon.scale.set(.5),this.addChild(this._icon)},b._init=function(){this._addGraph(),this._addText(),this._onFrameUpdateBound=this._onFrameUpdate.bind(this),nmm.runtime.appSetup.app.ticker.add(this._onFrameUpdateBound)},a}(),nmm.tools.Resize=function(){function a(a,b,c,d){this._default={w:c,h:d},this._renderer=a,this._stage=b,this._scale=null,this._size={},this._margin={},this._init()}return a.prototype._canvasResize=function(){this._size.windowWidth=window.innerWidth,this._size.windowHeight=window.innerHeight;var a=this._size.windowWidth/this._default.w,b=this._size.windowHeight/this._default.h;this._scale=Math.min(a,b),this._scale=this._scale<=1?this._scale:1,this._size.width=Math.floor(this._default.w*this._scale),this._size.height=Math.floor(this._default.h*this._scale),this._renderer.resize(this._size.width,this._size.height),this._stage.scale.x=this._scale,this._stage.scale.y=this._scale},a.prototype._canvasAlignment=function(){this._margin={},this._margin.x=(this._size.windowWidth-this._size.width)/2,this._margin.y=(this._size.windowHeight-this._size.height)/2,this._renderer.view.style.marginLeft=this._margin.x+"px",this._renderer.view.style.marginTop=this._margin.y+"px"},a.prototype._storeValues=function(){nmm.runtime.dimensions=nmm.runtime.dimensions||{},nmm.runtime.dimensions.windowWidth=this._size.windowWidth,nmm.runtime.dimensions.windowHeight=this._size.windowHeight,nmm.runtime.dimensions.scaledWidth=this._size.width,nmm.runtime.dimensions.scaledHeight=this._size.height,nmm.runtime.dimensions.marginLeft=this._margin.x,nmm.runtime.dimensions.marginTop=this._margin.y,nmm.runtime.dimensions.scale=this._scale},a.prototype.resize=function(){this._canvasResize(),this._canvasAlignment(),this._storeValues(),this._renderer.render(this._stage)},a.prototype._init=function(){this._resizeBound=this.resize.bind(this),window.addEventListener("resize",this._resizeBound),this.resize()},a}(),nmm.utils={shuffleArray:function(a){for(var b,c,d=a.length;d>0;)c=Math.floor(Math.random()*d),d--,b=a[d],a[d]=a[c],a[c]=b;return a}},nmm.engine.Application=function(){function a(){this._init()}var b=a.prototype;return b._assetsLoaded=function(){nmm.runtime.appSetup.stage.removeChild(this._preloader),this._preloader.destroy(),nmm.runtime.audio=new nmm.engine.AudioManager(nmm.app.audioSprite),nmm.runtime.scene=new nmm.app.SceneController,nmm.runtime.appSetup.stage.addChild(nmm.runtime.scene)},b._loadAssets=function(){var a=this._assetsLoaded.bind(this);this._loader=new nmm.engine.AssetsLoader(a)},b._addPreloader=function(){this._preloader=new nmm.tools.Preloader,nmm.runtime.appSetup.stage.addChild(this._preloader)},b._resizeApp=function(){new nmm.tools.Resize(nmm.runtime.appSetup.renderer,nmm.runtime.appSetup.stage,1024,768)},b._setupApp=function(){var a=window.devicePixelRatio,b=new PIXI.Application(1024,768,{resolution:window.devicePixelRatio,autoResize:!0,backgroundColor:5973599}),c=b.renderer,d=b.view,e=b.stage;document.body.appendChild(d),nmm.runtime.appSetup={app:b,renderer:c,view:d,stage:e},nmm.runtime.dimensions={},nmm.runtime.dimensions.resolution=a,nmm.runtime.dimensions.width=1024,nmm.runtime.dimensions.height=768},b._init=function(){this._setupApp(),this._resizeApp(),this._addPreloader(),this._loadAssets()},a}();